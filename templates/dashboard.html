<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard – Granja Stardew Valley</title>
  <link rel="stylesheet" href="../static/style.css" />
</head>

<body>
  <header class="top-bar">
    <h1 class="top-bar-title">Dashboard general</h1>
    <button onclick="window.location.href='/logout'" class="btn danger-btn">Cerrar sesión</button>
  </header>

  <main class="content">
    <div class="cards-grid" id="dashboard-cards">
      <!-- Aquí se insertarán las métricas -->
    </div>
  </main>

  <script>
    async function cargarDashboard() {
      try {
        const response = await fetch("/dashboard-metrics");
        const data = await response.json();

        const container = document.getElementById("dashboard-cards");
        container.innerHTML = ""; // limpiar

        const metricas = [
          { nombre: "Total animales", valor: data.total_animales },
          { nombre: "Total cultivos", valor: data.total_cultivos },
          { nombre: "Total productos registrados", valor: data.total_productos },
          { nombre: "Ventas totales del mes", valor: "$" + data.total_ventas_mes },
          { nombre: "Productos generados (animales)", valor: data.produccion_animal + " uds" },
          { nombre: "Productos generados (cultivos)", valor: data.produccion_cultivo + " uds" }
        ];

        metricas.forEach(m => {
          container.innerHTML += `
            <article class="mini-card">
              <h3>${m.nombre}</h3>
              <p style="font-size:1.4rem; font-weight:bold; margin-top:0.5rem;">
                ${m.valor}
              </p>
            </article>
          `;
        });

      } catch (error) {
        console.error("Error cargando dashboard:", error);
      }
    }

    cargarDashboard();
  </script>

</body>

</html>
